// This file was automatically generated by bifcl from /home/hendra/CCD/Source/DecisionTree_Analysis/src/decisiontree.bif (plugin mode).


#include "decisiontree.bif.h"


#line 3 "decisiontree.bif"
 #include "Plugin.h"
typedef plugin::Analysis_DecisionTree::Plugin plugin_t;
static plugin_t *plugin_ref = &plugin::Analysis_DecisionTree::plugin;

#line 8 "decisiontree.bif"
Val* BifFunc::DecisionTree::bro_Init(Frame* frame, val_list* BiF_ARGS)
	
#line 9 "decisiontree.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("DecisionTree::Init() takes exactly 1 argument(s)");
		return 0;
		}
	bro_uint_t n = (bro_uint_t) ((*BiF_ARGS)[0]->AsCount());

#line 9 "decisiontree.bif"

		plugin_ref->Init(n);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::DecisionTree::bro_Init

#line 12 "decisiontree.bif"

#line 14 "decisiontree.bif"
Val* BifFunc::DecisionTree::bro_LoadModel(Frame* frame, val_list* BiF_ARGS)
	
#line 15 "decisiontree.bif"
{
	if ( BiF_ARGS->length() != 2 )
		{
		reporter->Error("DecisionTree::LoadModel() takes exactly 2 argument(s)");
		return 0;
		}
	Val* ID = (Val*) ((*BiF_ARGS)[0]);
	StringVal* model_name = (StringVal*) ((*BiF_ARGS)[1]->AsStringVal());

#line 15 "decisiontree.bif"

		plugin_ref->LoadModel(ID, model_name);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::DecisionTree::bro_LoadModel

#line 18 "decisiontree.bif"

#line 20 "decisiontree.bif"
Val* BifFunc::DecisionTree::bro_Classify(Frame* frame, val_list* BiF_ARGS)
	
#line 21 "decisiontree.bif"
{
	if ( BiF_ARGS->length() != 2 )
		{
		reporter->Error("DecisionTree::Classify() takes exactly 2 argument(s)");
		return 0;
		}
	Val* ID = (Val*) ((*BiF_ARGS)[0]);
	Val* features = (Val*) ((*BiF_ARGS)[1]);

#line 21 "decisiontree.bif"

		plugin_ref->Classify(ID, features);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::DecisionTree::bro_Classify

#line 24 "decisiontree.bif"

#line 26 "decisiontree.bif"
Val* BifFunc::DecisionTree::bro_Classify_with_strings(Frame* frame, val_list* BiF_ARGS)
	
#line 28 "decisiontree.bif"
{
	if ( BiF_ARGS->length() != 3 )
		{
		reporter->Error("DecisionTree::Classify_with_strings() takes exactly 3 argument(s)");
		return 0;
		}
	Val* ID = (Val*) ((*BiF_ARGS)[0]);
	Val* features = (Val*) ((*BiF_ARGS)[1]);
	Val* features_str = (Val*) ((*BiF_ARGS)[2]);

#line 28 "decisiontree.bif"

		plugin_ref->Classify_with_strings(ID, features, features_str);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::DecisionTree::bro_Classify_with_strings

#line 31 "decisiontree.bif"

#line 33 "decisiontree.bif"
Val* BifFunc::DecisionTree::bro_Classify_record(Frame* frame, val_list* BiF_ARGS)
	
#line 34 "decisiontree.bif"
{
	if ( BiF_ARGS->length() != 2 )
		{
		reporter->Error("DecisionTree::Classify_record() takes exactly 2 argument(s)");
		return 0;
		}
	Val* ID = (Val*) ((*BiF_ARGS)[0]);
	Val* features = (Val*) ((*BiF_ARGS)[1]);

#line 34 "decisiontree.bif"

		plugin_ref->Classify_record(ID, features);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::DecisionTree::bro_Classify_record

#line 37 "decisiontree.bif"
namespace DecisionTree { EventHandlerPtr class_result_event;  }
void BifEvent::DecisionTree::generate_class_result_event(analyzer::Analyzer* analyzer, bro_int_t c)
	{
	// Note that it is intentional that here we do not
	// check if ::DecisionTree::class_result_event is NULL, which should happen *before*
	// BifEvent::DecisionTree::generate_class_result_event is called to avoid unnecessary Val
	// allocation.

	val_list* vl = new val_list;

	vl->append(new Val(c, TYPE_INT));

	mgr.QueueEvent(::DecisionTree::class_result_event, vl, SOURCE_LOCAL, analyzer->GetID(), timer_mgr);
	} // event generation
