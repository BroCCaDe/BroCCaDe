// This file was automatically generated by bifcl from /home/hendra/Experiment/IAT_Analysis/src/analysis.bif (plugin mode).


#include "analysis.bif.h"

namespace BifType { namespace Enum{ namespace FeatureAnalysis {  EnumType * Analysis_ID;  } } }

#line 12 "analysis.bif"
 #include "Plugin.h"
#include <cfloat>
typedef plugin::Analysis_FeatureAnalysis::Plugin plugin_t;
static plugin_t *plugin_ref = &plugin::Analysis_FeatureAnalysis::plugin;

#line 18 "analysis.bif"
Val* BifFunc::FeatureAnalysis::bro_Extract(Frame* frame, val_list* BiF_ARGS)
	
#line 19 "analysis.bif"
{
	if ( BiF_ARGS->length() != 3 )
		{
		reporter->Error("FeatureAnalysis::Extract() takes exactly 3 argument(s)");
		return 0;
		}
	Val* v = (Val*) ((*BiF_ARGS)[0]);
	Val* aid = (Val*) ((*BiF_ARGS)[1]);
	Val* tag = (Val*) ((*BiF_ARGS)[2]);

#line 19 "analysis.bif"

		return plugin_ref->Extract(v, aid, tag);
	} // end of BifFunc::FeatureAnalysis::bro_Extract

#line 21 "analysis.bif"

#line 23 "analysis.bif"
Val* BifFunc::FeatureAnalysis::bro_Extract_vector(Frame* frame, val_list* BiF_ARGS)
	
#line 24 "analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("FeatureAnalysis::Extract_vector() takes exactly 1 argument(s)");
		return 0;
		}
	Val* v = (Val*) ((*BiF_ARGS)[0]);

#line 24 "analysis.bif"

		return plugin_ref->ExtractVector(v);
	} // end of BifFunc::FeatureAnalysis::bro_Extract_vector

#line 26 "analysis.bif"

#line 29 "analysis.bif"
Val* BifFunc::FeatureAnalysis::bro_SetStepSize(Frame* frame, val_list* BiF_ARGS)
	
#line 30 "analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("FeatureAnalysis::SetStepSize() takes exactly 1 argument(s)");
		return 0;
		}
	bro_uint_t step_size = (bro_uint_t) ((*BiF_ARGS)[0]->AsCount());

#line 30 "analysis.bif"

		plugin_ref->SetStepSize(step_size);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::FeatureAnalysis::bro_SetStepSize

#line 33 "analysis.bif"

#line 35 "analysis.bif"
Val* BifFunc::FeatureAnalysis::bro_RemoveConn(Frame* frame, val_list* BiF_ARGS)
	
#line 36 "analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("FeatureAnalysis::RemoveConn() takes exactly 1 argument(s)");
		return 0;
		}
	StringVal* UID = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());

#line 36 "analysis.bif"

		plugin_ref->RemoveConnection(UID);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::FeatureAnalysis::bro_RemoveConn

#line 39 "analysis.bif"

#line 41 "analysis.bif"
Val* BifFunc::FeatureAnalysis::bro_RegisterAnalysis(Frame* frame, val_list* BiF_ARGS)
	
#line 43 "analysis.bif"
{
	if ( BiF_ARGS->length() != 4 )
		{
		reporter->Error("FeatureAnalysis::RegisterAnalysis() takes exactly 4 argument(s)");
		return 0;
		}
	StringVal* UID = (StringVal*) ((*BiF_ARGS)[0]->AsStringVal());
	double feature = (double) ((*BiF_ARGS)[1]->AsDouble());
	Val* aid = (Val*) ((*BiF_ARGS)[2]);
	Val* tag = (Val*) ((*BiF_ARGS)[3]);

#line 43 "analysis.bif"

		plugin_ref->RegisterAnalysis(UID, feature, aid, tag);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::FeatureAnalysis::bro_RegisterAnalysis

#line 46 "analysis.bif"

#line 48 "analysis.bif"
Val* BifFunc::FeatureAnalysis::bro_CalculateMetric(Frame* frame, val_list* BiF_ARGS)
	
#line 49 "analysis.bif"
{
	if ( BiF_ARGS->length() != 1 )
		{
		reporter->Error("FeatureAnalysis::CalculateMetric() takes exactly 1 argument(s)");
		return 0;
		}
	Val* id = (Val*) ((*BiF_ARGS)[0]);

#line 49 "analysis.bif"

	  	//plugin::PTunnel_Analysis::CalculateMetric(features);
		//plugin_ref->CalculateMetric(UID, features, aid, tag);
		plugin_ref->CalculateMetric(id);
		return new Val(1, TYPE_BOOL);
	} // end of BifFunc::FeatureAnalysis::bro_CalculateMetric

#line 54 "analysis.bif"
namespace FeatureAnalysis { EventHandlerPtr metric_event;  }
void BifEvent::FeatureAnalysis::generate_metric_event(analyzer::Analyzer* analyzer, Val* id, Val* v)
	{
	// Note that it is intentional that here we do not
	// check if ::FeatureAnalysis::metric_event is NULL, which should happen *before*
	// BifEvent::FeatureAnalysis::generate_metric_event is called to avoid unnecessary Val
	// allocation.

	val_list* vl = new val_list;

	vl->append(id);
	vl->append(v);

	mgr.QueueEvent(::FeatureAnalysis::metric_event, vl, SOURCE_LOCAL, analyzer->GetID(), timer_mgr);
	} // event generation
